g3
# Chunk 7: gaussian-kernel
# Chunk 8: sigma-transformation
# Chunk 9: gk-test
x1 <- c(1, 2, 1)
x2 = c(0, 4, -1)
sigma = 2
gk <- gkGenerator(sigma)
gk(x1, x2)
rbf <- rbfdot(sigTransform(sigma))
rbf(x1, x2)
str(rbf(x1, x2))
source('~/coursera-ml-R/ex6/ex6_chunks.R')
gk <- gkGenerator(sigma)
gk(x1, x2)
ex6data2 <- as.matrix(read.csv("../data/ex6data/ex6data2.csv"))
rbfSvm <- ksvm(V3 ~ V1 + V2,
data = ex6data2,
C = 10,
type = "C-svc",
kernel = gkGenerator,
kpar = list(sigma = 1),
scaled = F)
debug(rbfdot)
rbf <- rbfdot(sigTransform(sigma))
?new
new("rbfkernel", .Data = rval, kpar = list(sigma = sigma))
View(decisionBoundary)
undebug(rbfdot)
debug(rbf)
rbf(x1, x2)
debug(rbfdot)
rbf <- rbfdot(sigTransform(sigma))
gkg2 <- function (sigma = 1) {
gk <- function(xi, xj = NULL) {
normSquared <- sum((Xi - Xj) ^ 2)
return(as.matrix(exp(-normSquared / (2 * sigma ^ 2))))
}
return(new("gaussiankernel", .Data = gk, kpar = list(sigma = sigma)))
}
gk <- gkg2(sigma)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
gk <- gkg2(sigma)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
gk <- gkg2(sigma)
gk(x1, x2)
gk
str(gk)
gk@.Data()
gk@.Data
gk(xi = x1, xj = x2)
debug(gk)
gk(x1, x2)
xi
xj
source('~/coursera-ml-R/ex6/ex6_chunks.R')
gk <- gkGenerator(sigma)
gk(x1, x2)
rbfSvm <- ksvm(V3 ~ V1 + V2,
data = ex6data2,
C = 10,
type = "C-svc",
kernel = gkg2,
kpar = list(sigma = 1),
scaled = F)
rbfSvm
ex6data2 <- as.matrix(read.csv("../data/ex6data/ex6data2.csv"))
rbfSvm <- ksvm(V3 ~ V1 + V2,
data = ex6data2,
C = 10,
type = "C-svc",
kernel = "rbfdot"",
kpar = list(sigma = 1),
scaled = F)
rbfSvm
rbfSvm <- ksvm(V3 ~ V1 + V2,
data = ex6data2,
C = 10,
type = "C-svc",
kernel = "rbfdot",
kpar = list(sigma = 1),
scaled = F)
rbfSvm
undebug(rbfdot)
undebug(ksvm)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
gkSvm <- ksvm(V3 ~ V1 + V2,
data = ex6data2,
C = 1,
type = "C-svc",
kernel = gkGenerator,
kpar = list(sigma = 0.1),
scaled = F)
gkSvm
plot(gkSvm, data = as.data.frame(ex6data2))
ex6data2 <- ex6data2[, c(2, 1, 3)]
gkSvm <- ksvm(V3 ~ V2 + V1,
data = ex6data2,
C = 1,
type = "C-svc",
kernel = gkGenerator,
kpar = list(sigma = 0.1),
scaled = F)
gkSvm
plot(gkSvm, data = as.data.frame(ex6data2))
gkSvm <- ksvm(V3 ~ V2 + V1,
data = ex6data2,
C = 1,
type = "C-svc",
kernel = "rbfdot",
kpar = list(sigma = sigTransform(0.1)),
scaled = F)
gkSvm
plot(gkSvm, data = as.data.frame(ex6data2))
gkSvm <- ksvm(V3 ~ V2 + V1,
data = ex6data2,
C = 1,
type = "C-svc",
kernel = "rbfdot",
kpar = list(sigma = 0.1),
scaled = F)
gkSvm
plot(gkSvm, data = as.data.frame(ex6data2))
gkSvm <- ksvm(V3 ~ V2 + V1,
data = ex6data2,
C = 1,
type = "C-svc",
kernel = "rbfdot",
kpar = list(sigma = sigTransform(0.1)),
scaled = F)
gkSvm
plot(gkSvm, data = as.data.frame(ex6data2))
gkSvm <- ksvm(V3 ~ V2 + V1,
data = ex6data2,
C = 1,
type = "C-svc",
kernel = gkGenerator,
kpar = list(sigma = sigTransform(0.1)),
scaled = F)
gkSvm
plot(gkSvm, data = as.data.frame(ex6data2))
sigTransform(0.1)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
ex6data3 <- as.matrix(read.csv("../data/ex6data/ex6data3.csv"))
ex6data3_train <- as.matrix(read.csv("../data/ex6data/ex6data3_train.csv"))
# ex6data3 <- ex6data2[, c(2, 1, 3)]
ex6data3_test <- as.matrix(read.csv("../data/ex6data/ex6data3_test.csv"))
ex6data3_val <- as.matrix(read.csv("../data/ex6data/ex6data3_val.csv"))
g4 <- ggplot(as.data.frame(ex6data3_train), aes(V1, V2, shape = as.factor(V3)))
g4
g4 <- ggplot(as.data.frame(ex6data3_train), aes(V1, V2, shape = as.factor(V3)))+
geom_point()
g4
g4 <- ggplot(as.data.frame(ex6data3_train), aes(V1,
V2,
shape = as.factor(V3),
color = as.factor(V3))) +
geom_point()
g4
g4 <- ggplot(aes = aes(V1,
V2,
shape = as.factor(V3),
color = as.factor(V3)),
data = as.data.frame(ex6data3_train)) +
geom_point()
g4
g4 <- ggplot(as.data.frame(ex6data3_train), aes(V1, V2, shape = as.factor(V3),
color = as.factor(V3))) +
geom_point()
g4
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params <- data.frame
for(i in v){
for(j in v){
rbind(c(i, j))
}
params
params <- data.frame()
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params <- data.frame()
for(i in v){
for(j in v){
rbind(c(i, j))
}
params
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params <- data.frame()
for(i in v){
for(j in v){
rbind(params, c(i, j))
}
params
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params <- data.frame()
for(i in v){
for(j in v){
params <- rbind(params, c(i, j))
}
params
g4
rm(params)
rm(paramPerformace)
paramPerformance <- data.frame()
colnames(paramPerformance) <- c("C", "sigma", "train accuracy", "val accuracy")
gkSvm
str(gkSvm)
error(gkSvm)
?predict
ex3pred <- predict(ex3svm, ex6data3_val)
ex3pred <- predict(gkSvm, ex6data3_val)
ex3pred <- predict.ksvm(gkSvm, ex6data3_val)
?predict.ksvm
require(kernlab)
testpred <- predict.ksvm(gkSvm, ex6data3_val)
testpred <- predict(gkSvm, ex6data3_val)
testpred <- predict(gkSvm, ex6data2)
testpred <- predict(gkSvm, ex6data2[, c(2,1,3)])
source('~/coursera-ml-R/ex6/ex6_chunks.R')
debug(testParams)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
ex3svm
pred <- predict(ex3svm, val)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
debug(testParams)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
debug(testParams)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
paramPerformance
source('~/coursera-ml-R/ex6/ex6_chunks.R')
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
params3[which.min(params3$`val error`),]
source('~/coursera-ml-R/ex6/ex6_chunks.R')
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
params3[which.min(params3$val.error),]
source('~/coursera-ml-R/ex6/ex6_chunks.R')
params3[which.min(params3$train.error),]
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
params3[which.min(params3$val.error),]
params3[which.min(params3$train.error),]
?arrange
require(dplyr)
?arrange
arrange(params3, desc(val.error))
arrange(params3, train.error)
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
min.val.error <- params3[which.min(params3$val.error),]
svm3 <- ksvm(V3 ~ .,
data = ex6data3_train,
C = min.val.error$C,
type = "C-svc",
kernel = gkGenerator,
kpar = list(sigma = sigTransform(min.val.error$sigma)))
svm3
plot(svm3, data = as.data.frame(ex6data3_train))
v <- c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)
params3 <- testParams(ex6data3_train, ex6data3_val, v, v)
min.val.error <- params3[which.min(params3$val.error),]
svm3 <- ksvm(V3 ~ V2 + V1,
data = ex6data3_train,
C = min.val.error$C,
type = "C-svc",
kernel = gkGenerator,
kpar = list(sigma = sigTransform(min.val.error$sigma)))
plot(svm3, data = as.data.frame(ex6data3_train))
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope,
color = 3, show_guide=TRUE)
g3
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope,
color = 3, show.legend=TRUE)
g3
?show.legend
bound1 <- decisionBoundary(linSvm1)
g2 <- g1 + geom_abline(intercept = bound1$intcpt, slope = bound1$slope,
color = 2, show.legend=TRUE)
g2
linSvm2 <- ksvm(V3 ~ V2 + V1,
data = ex6data1,
C = 100,
type = "C-svc",
kernel = "vanilladot",
kpar = list(),
scaled = F)
bound2 <- decisionBoundary(linSvm2)
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope,
color = 3, show.legend=TRUE)
g3
bound1 <- decisionBoundary(linSvm1)
g2 <- g1 + geom_abline(intercept = bound1$intcpt, slope = bound1$slope, color = 2)
g2
linSvm2 <- ksvm(V3 ~ V2 + V1,
data = ex6data1,
C = 100,
type = "C-svc",
kernel = "vanilladot",
kpar = list(),
scaled = F)
bound2 <- decisionBoundary(linSvm2)
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope, color = 3) +
guides(shape = guide_legend(override.aes = list(linetype = 0)))
g3
bound1 <- decisionBoundary(linSvm1)
g2 <- g1 + geom_abline(intercept = bound1$intcpt, slope = bound1$slope, color = 2)
g2
linSvm2 <- ksvm(V3 ~ V2 + V1,
data = ex6data1,
C = 100,
type = "C-svc",
kernel = "vanilladot",
kpar = list(),
scaled = F)
bound2 <- decisionBoundary(linSvm2)
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope, color = 3) +
guides(shape = guide_legend(override.aes = list(linetype = 1)))
g3
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope,
color = 3, show.legend = TRUE) +
guides(shape = guide_legend(override.aes = list(linetype = 1)))
g3
bound1 <- decisionBoundary(linSvm1)
g2 <- g1 + geom_abline(intercept = bound1$intcpt, slope = bound1$slope, color = 2, show.legend = TRUE)
g2
linSvm2 <- ksvm(V3 ~ V2 + V1,
data = ex6data1,
C = 100,
type = "C-svc",
kernel = "vanilladot",
kpar = list(),
scaled = F)
bound2 <- decisionBoundary(linSvm2)
g3 <- g2 +
geom_abline(intercept = bound2$intcpt, slope = bound2$slope,
color = 3, show.legend = TRUE) +
guides(shape = guide_legend(override.aes = list(linetype = 1)))
g3
bound1 <- decisionBoundary(linSvm1)
g2 <- g1 + geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, color = "1")
g2
linSvm2 <- ksvm(V3 ~ V2 + V1,
data = ex6data1,
C = 100,
type = "C-svc",
kernel = "vanilladot",
kpar = list(),
scaled = F)
bound2 <- decisionBoundary(linSvm2)
g3 <- g2 +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, color = "100")
g3
g3 <- g2 +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, color = "100") +
scale_colour_discrete("")
g3
g1 + geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, color = "1") +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, color = "100") +
scale_colour_discrete("")
ggplot(data = as.data.frame(ex6data1), aes(V1, V2)) + #, shape = as.factor(V3)
geom_point() +
geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, color = "1") +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, color = "100") +
scale_colour_discrete("")
ggplot(data = as.data.frame(ex6data1), aes(V1, V2)) + #, shape = as.factor(V3)
geom_point() +
geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, color = "c=1") +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, color = "c=100") +
scale_colour_discrete("")
ggplot(data = as.data.frame(ex6data1), aes(V1, V2)) + #, shape = as.factor(V3)
geom_point() +
geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, color = "abcd") +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, color = "xyz") +
scale_colour_discrete("")
bound1 <- decisionBoundary(linSvm1)
g2 <- g1 + geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, aes(color = "c=1"))
g2
linSvm2 <- ksvm(V3 ~ V2 + V1,
data = ex6data1,
C = 100,
type = "C-svc",
kernel = "vanilladot",
kpar = list(),
scaled = F)
bound2 <- decisionBoundary(linSvm2)
g3 <- g2 +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, aes(color = "c=100")) +
scale_colour_discrete("")
g3
ggplot(data = as.data.frame(ex6data1), aes(V1, V2)) + #, shape = as.factor(V3)
geom_point() +
geom_abline(intercept = bound1$intcpt,
slope = bound1$slope, aes(color = "abcd")) +
geom_abline(intercept = bound2$intcpt,
slope = bound2$slope, aes(color = "xyz")) +
scale_colour_discrete("")
ggplot(as.data.frame(ex6data1), aes(x = V1, y = V2)) +
geom_point(size = 3)
ggplot(as.data.frame(ex6data1), aes(x = V1, y = V2)) +
geom_point() +
geom_abline(aes(colour="one-to-one"), intercept =0, slope = 1, size = 1) +
stat_smooth(aes(colour="best fit"), method = "lm", se = FALSE, size = 1) +
#facet_wrap(~ type) +
scale_colour_discrete("")
ggplot(as.data.frame(ex6data1), aes(x = V1, y = V2)) +
geom_point() +
stat_smooth(aes(colour="best fit"), method = "lm", se = FALSE, size = 1) +
geom_abline(aes(colour="one-to-one"), intercept =0, slope = 1, size = 1) +
#facet_wrap(~ type) +
scale_colour_discrete("")
ggplot(as.data.frame(ex6data1), aes(x = V1, y = V2)) +
geom_point() +
geom_abline(aes(colour="one-to-one"), intercept =0, slope = 1, size = 1) +
stat_smooth(aes(colour="best fit"), method = "lm", se = FALSE, size = 1) +
#facet_wrap(~ type) +
scale_colour_discrete("")
?readLines
readLines(file("../data/ex6data/emailSample1.txt", open = "r"))
?writeLines
writeLines(readLines(file("../data/ex6data/emailSample1.txt", open = "r")))
con <- file("../data/ex6data/emailSample1.txt", open = "r")
writeLines(readLines(con))
close(con)
?gsub
source('~/coursera-ml-R/ex6/ex6_chunks.R')
debug(preProcess)
con <- file("../data/ex6data/emailSample1.txt", open = "r")
a <- writeLines(readLines(con))
close(con)
a
con <- file("../data/ex6data/emailSample1.txt", open = "r")
a <- readLines(con)
con
a
str(a)
a <- paste(a, collapse = "")
a
preProcess(a)
email
source('~/coursera-ml-R/ex6/ex6_chunks.R')
'(http|https)://[^\\s]*'
'(http|https)://[^\s]*'
'(http|https)://[^\\\\s]*'
mystring <- '(http|https)://[^\\s]*'
mystring
'(http|https)://[^\s]*'
?regex
source('~/coursera-ml-R/ex6/ex6_chunks.R')
setwd(ex6)
setwd("ex6")
con <- file("../data/ex6data/emailSample1.txt", open = "r")
writeLines(readLines(con))
close(con)
con <- file("../data/ex6data/emailSample1.txt", open = "r")
sampleEmail1 <-writeLines(readLines(con))
close(con)
sampleEmail1
con <- file("../data/ex6data/emailSample1.txt", open = "r")
writeLines(readLines(con))
sampleEmail1 <- paste(readLines(con), collapse = "")
close(con)
sampleEmail1
a <- readLines(con)
a <- paste(a, collapse = "")
a
con <- file("../data/ex6data/emailSample1.txt", open = "r")
writeLines(readLines(con))
readLines(con)
con <- file("../data/ex6data/emailSample1.txt", open = "r")
sampleEmail1 <- paste(readLines(con), collapse = "")
sampleEmail1
con <- file("../data/ex6data/emailSample1.txt", open = "r")
lines <- readLines(con)
close(con)
writeLines(lines)
sampleEmail1 <- paste(lines), collapse = "")
sampleEmail1
sampleEmail1 <- paste(lines, collapse = "")
sampleEmail1
debug(preProcess)
preProcess(sampleEmail1)
tolower(email)
email
con <- file("../data/ex6data/emailSample1.txt", open = "r")
lines <- readLines(con)
close(con)
writeLines(lines)
sampleEmail1 <- paste(lines, collapse = " ")
sampleEmail1
undebug(preProcess)
preProcess(sampleEmail1)
source('~/coursera-ml-R/ex6/ex6_chunks.R')
